import {
  Stream
} from "./chunk-APFLTC63.js";
import {
  require_jsx_runtime
} from "./chunk-UZXVLKWH.js";
import {
  require_react
} from "./chunk-CISLU2WX.js";
import {
  __toESM
} from "./chunk-7D4SUZUM.js";

// node_modules/.pnpm/@motiadev+stream-client-react@0.13.1-beta.162_react@19.2.0/node_modules/@motiadev/stream-client-react/dist/src/motia-stream-provider.js
var import_jsx_runtime = __toESM(require_jsx_runtime());
var import_react2 = __toESM(require_react());

// node_modules/.pnpm/@motiadev+stream-client-react@0.13.1-beta.162_react@19.2.0/node_modules/@motiadev/stream-client-react/dist/src/motia-stream-context.js
var import_react = __toESM(require_react());
var MotiaStreamContext = import_react.default.createContext({
  stream: null
});

// node_modules/.pnpm/@motiadev+stream-client-react@0.13.1-beta.162_react@19.2.0/node_modules/@motiadev/stream-client-react/dist/src/motia-stream-provider.js
var MotiaStreamProvider = ({ children, address, protocols }) => {
  const [stream, setStream] = (0, import_react2.useState)(null);
  (0, import_react2.useEffect)(() => {
    const streamInstance = new Stream(address, { protocols });
    setStream(streamInstance);
    return () => streamInstance.close();
  }, [address, protocols]);
  const contextValue = (0, import_react2.useMemo)(() => ({ stream }), [stream]);
  return (0, import_jsx_runtime.jsx)(MotiaStreamContext.Provider, { value: contextValue, children });
};

// node_modules/.pnpm/@motiadev+stream-client-react@0.13.1-beta.162_react@19.2.0/node_modules/@motiadev/stream-client-react/dist/src/use-motia-stream.js
var import_react3 = __toESM(require_react());
var useMotiaStream = () => {
  const context = import_react3.default.useContext(MotiaStreamContext);
  if (!context) {
    throw new Error("useMotiaStream must be used within a MotiaStreamProvider");
  }
  return context;
};

// node_modules/.pnpm/@motiadev+stream-client-react@0.13.1-beta.162_react@19.2.0/node_modules/@motiadev/stream-client-react/dist/src/use-stream-event-handler.js
var import_react4 = __toESM(require_react());
var useStreamEventHandler = ({ event, type, listener }, dependencies) => {
  (0, import_react4.useEffect)(() => {
    if (event) {
      event.onEvent(type, listener);
      return () => event.offEvent(type, listener);
    }
  }, [event, type, ...dependencies]);
};

// node_modules/.pnpm/@motiadev+stream-client-react@0.13.1-beta.162_react@19.2.0/node_modules/@motiadev/stream-client-react/dist/src/use-stream-group.js
var import_react5 = __toESM(require_react());
var useStreamGroup = (args) => {
  const { stream } = useMotiaStream();
  const [data, setData] = (0, import_react5.useState)([]);
  const [event, setEvent] = (0, import_react5.useState)(null);
  const { streamName, groupId, sortKey } = args || {};
  const handleChange = (0, import_react5.useCallback)((data2) => {
    setData(data2);
  }, []);
  (0, import_react5.useEffect)(() => {
    if (!streamName || !groupId || !stream)
      return;
    const subscription = stream.subscribeGroup(streamName, groupId, sortKey);
    subscription.addChangeListener(handleChange);
    setEvent(subscription);
    return () => {
      setData([]);
      setEvent(null);
      subscription.close();
    };
  }, [stream, streamName, groupId, sortKey, handleChange]);
  return { data, event };
};

// node_modules/.pnpm/@motiadev+stream-client-react@0.13.1-beta.162_react@19.2.0/node_modules/@motiadev/stream-client-react/dist/src/use-stream-item.js
var import_react6 = __toESM(require_react());
var useStreamItem = (args) => {
  const { stream } = useMotiaStream();
  const [data, setData] = (0, import_react6.useState)();
  const [event, setEvent] = (0, import_react6.useState)(null);
  const { streamName, groupId, id } = args || {};
  const handleChange = (0, import_react6.useCallback)((data2) => {
    setData(data2);
  }, []);
  (0, import_react6.useEffect)(() => {
    if (!streamName || !groupId || !id || !stream)
      return;
    const subscription = stream.subscribeItem(streamName, groupId, id);
    subscription.addChangeListener(handleChange);
    setEvent(subscription);
    return () => {
      setData(void 0);
      setEvent(null);
      subscription.close();
    };
  }, [stream, streamName, groupId, id, handleChange]);
  return { data, event };
};

export {
  MotiaStreamProvider,
  useMotiaStream,
  useStreamEventHandler,
  useStreamGroup,
  useStreamItem
};
//# sourceMappingURL=chunk-XBTJWNXQ.js.map
